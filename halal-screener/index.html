<!DOCTYPE html>
<html lang="en" class="dark">
    <script>
        const prefersDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches;
        const isDarkMode = prefersDarkMode;
        const html = document.querySelector("html");
        if(isDarkMode) {
            html.classList.add("dark");
        } else {
            html.classList.remove("dark");
        }
    </script>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../style.css">
        <link rel="icon" href="../assets/me.jpg">
        <title>Hanafi Halal Stock Screener | Kenan Erol</title>
        <meta name="description" content="Strict Hanafi Halal Stock Screener - Check if a stock is Shariah compliant">
        <style>
            .screener-container {
                max-width: 800px;
                margin: 0 auto;
                padding: 2rem 1rem;
            }
            .input-section {
                display: flex;
                flex-direction: column;
                gap: 1rem;
                margin-bottom: 2rem;
            }
            .input-row {
                display: flex;
                gap: 0.5rem;
                flex-wrap: wrap;
            }
            .input-field {
                padding: 0.75rem 1rem;
                border: 1px solid #065f46;
                border-radius: 0.5rem;
                background: #064e3b;
                color: white;
                font-size: 1rem;
                flex: 1;
                min-width: 150px;
            }
            .input-field::placeholder {
                color: #a7f3d0;
            }
            .btn {
                padding: 0.75rem 1.5rem;
                background: #10b981;
                color: white;
                border: none;
                border-radius: 0.5rem;
                font-size: 1rem;
                cursor: pointer;
                font-weight: bold;
                transition: background 0.2s;
            }
            .btn:hover {
                background: #059669;
            }
            .btn:disabled {
                background: #6b7280;
                cursor: not-allowed;
            }
            .results-card {
                background: #064e3b;
                border-radius: 1rem;
                padding: 1.5rem;
                margin-top: 1.5rem;
            }
            .stock-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            .stock-name {
                font-size: 1.5rem;
                font-weight: bold;
            }
            .stock-price {
                font-size: 1.25rem;
                color: #a7f3d0;
            }
            .report-date {
                font-size: 0.9rem;
                color: #86efac;
                opacity: 0.8;
                width: 100%;
                text-align: center;
            }
            .check-item {
                background: #065f46;
                border-radius: 0.5rem;
                padding: 1rem;
                margin-bottom: 1rem;
            }
            .check-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0.5rem;
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            .check-title {
                font-weight: bold;
                font-size: 1.1rem;
            }
            .check-status {
                padding: 0.25rem 0.75rem;
                border-radius: 1rem;
                font-weight: bold;
                font-size: 0.875rem;
            }
            .pass {
                background: #10b981;
                color: white;
            }
            .fail {
                background: #ef4444;
                color: white;
            }
            .check-details {
                font-size: 0.9rem;
                color: #d1fae5;
                margin-top: 0.5rem;
            }
            .check-formula {
                font-family: monospace;
                background: #047857;
                padding: 0.5rem;
                border-radius: 0.25rem;
                margin-top: 0.5rem;
                font-size: 0.85rem;
                overflow-x: auto;
            }
            .field-mapping {
                background: #0d9488;
                padding: 0.75rem;
                border-radius: 0.25rem;
                margin-bottom: 0.5rem;
                line-height: 1.6;
            }
            .field-label {
                font-weight: bold;
                color: #ffffff;
            }
            .yahoo-field {
                color: #a7f3d0;
                font-size: 0.8rem;
                font-style: italic;
            }
            .calculation-box {
                background: #065f46;
                padding: 0.5rem;
                border-radius: 0.25rem;
                line-height: 1.5;
            }
            .verify-link {
                color: #6ee7b7;
                text-decoration: underline;
                font-size: 0.85rem;
            }
            .verify-link:hover {
                color: #a7f3d0;
            }
            .overall-result {
                text-align: center;
                padding: 1.5rem;
                border-radius: 0.5rem;
                margin-top: 1rem;
                font-size: 1.5rem;
                font-weight: bold;
            }
            .overall-pass {
                background: #10b981;
            }
            .overall-fail {
                background: #ef4444;
            }
            .error-message {
                background: #7f1d1d;
                color: #fecaca;
                padding: 1rem;
                border-radius: 0.5rem;
                margin-top: 1rem;
            }
            .loading {
                text-align: center;
                padding: 2rem;
                color: #a7f3d0;
            }
            .info-box {
                background: #065f46;
                border-radius: 0.5rem;
                padding: 1rem;
                margin-bottom: 1.5rem;
                font-size: 0.9rem;
            }
            .info-box a {
                color: #6ee7b7;
            }
            .api-key-section {
                margin-bottom: 1rem;
            }
            .api-key-saved {
                color: #6ee7b7;
                font-size: 0.875rem;
            }
            .rate-limit-info {
                margin-top: 1rem;
                padding: 0.75rem;
                background: rgba(6, 95, 70, 0.5);
                border-radius: 0.5rem;
                text-align: center;
            }
            .request-counter {
                font-size: 0.875rem;
                color: #a7f3d0;
                margin: 0;
            }
            .request-counter.warning {
                color: #fbbf24;
                font-weight: bold;
            }
            .cooldown-timer {
                font-size: 1rem;
                color: #fbbf24;
                margin-top: 0.5rem;
                font-weight: bold;
                animation: pulse 1s ease-in-out infinite;
            }
            @keyframes pulse {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.6; }
            }
            .hidden {
                display: none;
            }
            .data-sources {
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid #065f46;
            }
            .threshold-note {
                font-size: 0.8rem;
                color: #a7f3d0;
                font-style: italic;
            }
            
            /* FORCE header text to be visible */
            body > header {
                color: #333333 !important;
            }
            html.dark body > header {
                color: #f0f0f0 !important;
            }
            
            /* Force navbar items visible on large screens */
            @media (min-width: 1024px) {
                .navbar-menu,
                .navbar-social {
                    display: inline-block !important;
                }
            }
        </style>
    </head>
    <body class="text-textColor dark:darktext-textColor dark:bg-emerald-800">
        <header class="sticky top-0 z-50 w-full shadow-md bg-white dark:bg-emerald-900 text-textColor dark:darktext-textColor text-sm">
            <div class="flex items-center lg:mx-10 mx-6 py-4">
                <div>
                    <a key="home" href="/index.html">
                        <!-- <img class="h-6 lg:h-10" src="../assets/kenanhead1.png" alt="Kenan Erol"> -->
						Home
                    </a>
                </div>
                <!-- <a href="/index.html" to="/" class="pl-8"> Kenan Giray Erol </a> -->
                <div class="flex-grow"></div>
                <div class="navbar-menu hidden lg:inline-block flex items-center">
                    <!---portfolio contact research also add a contact me ting-->
                    <a href="/projects.html" class="pl-8 py-2"> Projects </a>
                    <!-- <a href="/research.html" class="pl-8 py-2"> Research </a> -->
                </div>
                <div class="navbar-social hidden lg:inline-block flex items-center pl-8">
                    <a href="https://linkedin.com/in/kgerol"> <div class="inline-block"><img class="h-6 lg:h-10"  src="../assets/ratio.svg" alt="linkedin"></div> </a>
					<!-- class="h-6 lg:h-10" -->
                    <a href="https://github.com/kenan-erol"> <div class="inline-block pl-8"><img class="h-6 lg:h-10" src="../assets/git.svg" alt="github"></div> </a>
                    <a href="https://devpost.com/kenan-erol"> <div class="inline-block pl-8"><img class="h-6 lg:h-10" src="../assets/devpost.svg" alt="Devpost"></div> </a>
                    <!-- <a href="https://instagram.com/kenan_giray10/"> <div class="inline-block pl-8"><img class="h-6 lg:h-10" src="../assets/instagram-color-svgrepo-com.svg" alt="Kenan Erol"></div> </a> -->
                </div>
                <!---mobile-->
                <div class="lg:hidden">
                    <button id="menuToggle" aria-label="menu" class="block focus:outline-none">
                        <div class="menu-toggle h-6 w-6">
                            <!-- <svg class="stroke-textColor dark:stroke-textColor"  viewBox="0 0 20 20" width="20" height="20" xmlns="http://www.w3.org/2000/svg">
                                <line class="top" x1="0" y1="2" x2="20" y2="2" style="stroke-width: 2"></line>
                                <line class="middle" x1="0" y1="10" x2="20" y2="10" style="stroke-width: 2"></line>
                                <line class="bottom" x1="0" y1="18" x2="20" y2="18" style="stroke-width: 2"></line>
                            </svg> -->
                            <div id="nav-icon3">
                                <span class="stroke-textDarkColor dark:stroke-textColor"></span>
                                <span class="stroke-textDarkColor dark:stroke-textColor"></span>
                                <span class="stroke-textDarkColor dark:stroke-textColor"></span>
                                <span class="stroke-textDarkColor dark:stroke-textColor"></span>
                              </div>
                        </div>
                        </div>
                    </button>
                </div>
                
                <div id="mobileMenu" class="mobile-menu hidden block border-t mx-6 py-8">
                    <div class="text-center"><a href="/projects.html" class="block py-8"> Projects </a>
                    <!-- <a href="/research.html" class="block py-2"> Research </a></div> -->
                    <div class="flex justify-center">
                        <a href="https://linkedin.com/in/kgerol"> <div class="block py-8"><img class="h-6 lg:h-10" src="../assets/linkedin-svgrepo-com.svg" alt="linkedin"></div> </a>
                        <a href="https://github.com/kenan-erol"> <div class="block py-8 pl-8"><img class="h-6 lg:h-10" src="../assets/git.svg" alt="github"></div> </a> </div>
                    <div class="flex justify-center">
						<a href="https://devpost.com/kenan-erol"> <div class="block py-4"><img class="h-6 lg:h-10" src="../assets/devpost.svg" alt="Devpost"></div> </a>
                        <a href="https://instagram.com/kenan_giray10/">
						<div class="block py-4 pl-8"><img class="h-6 lg:h-10" src="../assets/instagram-color-svgrepo-com.svg" alt="Kenan Erol"></div> </a>
                    </div>
                </div>
                
                <script>
                    const menuToggle = document.getElementById('nav-icon3');
                    const mobileMenu = document.getElementById('mobileMenu');
                
                    menuToggle.addEventListener('click', function() {
                        //console.log('clicked');
                        mobileMenu.classList.toggle('hidden');
                        //$(this).toggleClass('open');
                        menuToggle.classList.toggle('open');
                    });

                    /*$(document).ready(function(){
                        $('#nav-icon3').click(function(){
                            $(this).toggleClass('open');
                        });
                    });*/
                </script>
                
        </header>
        
        <main class="relative min-h-screen">
            <div class="screener-container">
                <h1 class="text-3xl font-bold mb-2">Strict Hanafi Halal Stock Screener</h1>
                <p class="mb-4">Check if a stock meets strict Hanafi Shariah compliance criteria</p>
                
                <div class="info-box">
                    <p><strong>What this checks:</strong></p>
                    <ol class="list-decimal ml-4 mt-2">
                        <li><strong>Illiquid Asset Ratio ‚â• 20%</strong> - Company must have substantial tangible assets</li>
                        <li><strong>Price > Net Liquid Assets/Share</strong> - Prevents buying cash at a discount (Riba)</li>
                        <li><strong>Debt to Assets < 37%</strong> - Company isn't excessively leveraged (based on 1/3 rule)</li>
                    </ol>
                    <p class="mt-2 text-sm"><strong>Why 37% (one-third)?</strong> This threshold is based on <a href="https://aaoifi.com/shariaa-standards/?lang=en" target="_blank" style="color: #6ee7b7;">AAOIFI Shariah Standard 21</a> which sets 33% as the maximum for interest-bearing debt. The 37% allows for minor fluctuations. Learn more: <a href="https://www.investopedia.com/terms/s/shariah-compliant-funds.asp" target="_blank" style="color: #6ee7b7;">Investopedia on Shariah Funds</a></p>
                    <p class="mt-2 text-sm">Get your free API key from <a href="https://www.alphavantage.co/support/#api-key" target="_blank" style="color: #6ee7b7;">Alpha Vantage</a> (25 requests/day on free tier).</p>
                </div>

                <div class="input-section">
                    <div class="api-key-section">
                        <label class="block mb-1">API Key (from <a href="https://www.alphavantage.co/support/#api-key" target="_blank" style="color: #6ee7b7;">Alpha Vantage</a> - free tier)</label>
                        <div class="input-row">
                            <input type="password" id="apiKey" class="input-field" placeholder="Enter your Alpha Vantage API key">
                            <button id="saveKeyBtn" class="btn">Save Key</button>
                        </div>
                        <p id="keySavedMsg" class="api-key-saved hidden">‚úì API key saved in browser</p>
                    </div>
                    
                    <div>
                        <label class="block mb-1">Stock Ticker</label>
                        <div class="input-row">
                            <input type="text" id="ticker" class="input-field" placeholder="e.g., AAPL, TSMC, MSFT" style="text-transform: uppercase;">
                            <button id="analyzeBtn" class="btn">Analyze</button>
                        </div>
                    </div>
                    
                    <div class="rate-limit-info">
                        <p id="requestCounter" class="request-counter">Loading...</p>
                        <p id="cooldownTimer" class="cooldown-timer hidden"></p>
                    </div>
                </div>

                <div id="loading" class="loading hidden">
                    <p>‚è≥ Fetching financial data...</p>
                </div>

                <div id="error" class="error-message hidden"></div>

                <div id="results" class="hidden">
                    <div class="results-card">
                        <div class="stock-header">
                            <span class="stock-name" id="stockName"></span>
                            <span class="stock-price" id="stockPrice"></span>
                            <span class="report-date" id="reportDate"></span>
                        </div>

                        <!-- Check 1: Illiquid Asset Ratio -->
                        <div class="check-item">
                            <div class="check-header">
                                <span class="check-title">1. Illiquid Asset Ratio</span>
                                <span id="check1Status" class="check-status"></span>
                            </div>
                            <p class="check-details">
                                Ensures the company is a "real business" with tangible assets, not just cash/debt.
                            </p>
                            <p class="threshold-note">Threshold: ‚â• 20%</p>
                            <div class="check-formula" id="check1Formula"></div>
                            <div class="data-sources">
                                <a id="check1Link" class="verify-link" target="_blank">üìä Verify on Yahoo Finance Balance Sheet ‚Üí</a>
                            </div>
                        </div>

                        <!-- Check 2: Net Liquid Assets vs Price -->
                        <div class="check-item">
                            <div class="check-header">
                                <span class="check-title">2. Net Liquid Assets vs. Price</span>
                                <span id="check2Status" class="check-status"></span>
                            </div>
                            <p class="check-details">
                                Prevents buying cash at a discount (Riba). Stock price must exceed net liquid assets per share.
                            </p>
                            <p class="threshold-note">Threshold: Price > Net Liquid Assets per Share</p>
                            <div class="check-formula" id="check2Formula"></div>
                            <div class="data-sources">
                                <a id="check2Link" class="verify-link" target="_blank">üìä Verify on Yahoo Finance Balance Sheet ‚Üí</a>
                            </div>
                        </div>

                        <!-- Check 3: Debt to Assets -->
                        <div class="check-item">
                            <div class="check-header">
                                <span class="check-title">3. Debt to Total Assets</span>
                                <span id="check3Status" class="check-status"></span>
                            </div>
                            <p class="check-details">
                                Ensures the company isn't excessively leveraged with interest-bearing debt.
                            </p>
                            <p class="threshold-note">Threshold: < 37%</p>
                            <div class="check-formula" id="check3Formula"></div>
                            <div class="data-sources">
                                <a id="check3Link" class="verify-link" target="_blank">üìä Verify on Yahoo Finance Balance Sheet ‚Üí</a>
                            </div>
                        </div>

                        <!-- Overall Result -->
                        <div id="overallResult" class="overall-result"></div>
                    </div>
                </div>
            </div>
        </main>

        <script src="app.js"></script>
    </body>
</html>
